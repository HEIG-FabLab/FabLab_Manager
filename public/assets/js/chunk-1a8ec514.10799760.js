(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1a8ec514"],{"0419":function(t,e,n){"use strict";n("c7ba")},"3f29":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{style:{display:"flex","justify-content":"center","padding-bottom":"15px"}},[n("v-btn",{attrs:{disabled:!(t.selectedJobs.length>0),color:"green"},on:{click:function(e){t.dialog=!0}}},[t._v("Assigner")])],1),t._v(" "),n("v-data-table",{ref:"table",attrs:{headers:t.headers,items:t.jobs,"item-key":"id","show-select":""},scopedSlots:t._u([{key:"header.data-table-select",fn:function(){},proxy:!0},{key:"item.job_category",fn:function(e){var n=e.item;return[t._v("\n      "+t._s(n.job_category.name)+"\n    ")]}},{key:"item.created_at",fn:function(e){var a=e.item;return[n("v-tooltip",{attrs:{bottom:"",disabled:t.isTouchscreen},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on,i=e.attrs;return[n("span",t._g(t._b({},"span",i,!1),s),[t._v(t._s(t.moment(a.created_at).fromNow()))])]}}],null,!0)},[t._v(" "),n("span",[t._v("Déposé le "+t._s(t.moment(a.created_at).format("DD/MM/YYYY")))])])]}},{key:"item.deadline",fn:function(e){var a=e.item;return[n("v-tooltip",{attrs:{bottom:"",disabled:t.isTouchscreen},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on,i=e.attrs;return[n("span",t._g(t._b({},"span",i,!1),s),[t._v(t._s(t.moment(a.deadline).fromNow()))])]}}],null,!0)},[t._v(" "),n("span",[t._v("Jusqu'au "+t._s(t.moment(a.deadline).format("DD/MM/YYYY")))])])]}},{key:"item.client_name",fn:function(e){var a=e.item;return[n("v-tooltip",{attrs:{bottom:"",disabled:t.isTouchscreen},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on,i=e.attrs;return[n("span",t._g(t._b({},"span",i,!1),s),[t._v(t._s(a.client.name.charAt(0)+"."+a.client.surname))])]}}],null,!0)},[t._v(" "),n("span",[t._v(t._s(a.client.name+" "+a.client.surname))])])]}},{key:"item.description",fn:function(e){var a=e.item;return["null"!==a.description?n("v-dialog",{attrs:{"max-width":"80%","content-class":"comment"},scopedSlots:t._u([{key:"activator",fn:function(e){var a=e.on,s=e.attrs;return[n("v-btn",t._g(t._b({attrs:{text:""}},"v-btn",s,!1),a),[n("v-icon",[t._v(t._s(t.mdiCommentEyeOutline))])],1)]}}],null,!0)},[t._v(" "),n("v-card",[n("v-card-title",{staticClass:"text-h5"},[t._v(" Commentaire ")]),t._v(" "),n("v-card-text",[t._v(t._s(a.description))])],1)],1):n("span",[t._v("Aucun")])]}}]),model:{value:t.selectedJobs,callback:function(e){t.selectedJobs=e},expression:"selectedJobs"}}),t._v(" "),n("v-dialog",{attrs:{width:"450"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[n("v-card",[n("v-card-title",{staticClass:"headline grey lighten-2"},[t._v("\n        Attribution des demandes\n      ")]),t._v(" "),n("v-card-text",[n("br"),t._v(" "),n("br"),t._v("\n        "+t._s(t.assignText)+"\n      ")]),t._v(" "),n("v-divider"),t._v(" "),n("v-card-actions",[n("v-spacer"),t._v(" "),n("v-btn",{attrs:{color:"red",text:""},on:{click:function(e){t.dialog=t.loading=!1}}},[t._v("\n          Annuler\n        ")]),t._v(" "),n("v-btn",{attrs:{color:"primary",text:"",loading:t.loading},on:{click:t.assign}},[t._v("\n          Valider\n        ")])],1)],1)],1)],1)},s=[],i=n("5530"),o=(n("d3b7"),n("d81d"),n("4de4"),n("2f62")),r=n("94ed"),c=n("c1df"),l=n.n(c),d={data:function(){return{headers:[{text:"Travail",value:"job_category"},{text:"Date de création",value:"created_at"},{text:"Échéance",value:"deadline"},{text:"Client",value:"client_name"},{text:"Commentaire",value:"description",align:"center",sortable:!1}],dialog:!1,loading:!1,selectedJobs:[],mdiCommentEyeOutline:r["f"],moment:l.a}},methods:Object(i["a"])(Object(i["a"])({},Object(o["b"])(["retrieveUnassignedJobs","assignJob"])),{},{assign:function(){var t=this;this.loading=!0,this.assignJob(this.selectedJobs.map((function(t){return t.id}))).then((function(e){t.$notify("success filled","Demandes assignées !","Les demandes vous ont été assignés",{duration:4e3,permanent:!1}),t.dialog=!1})).catch((function(e){console.log(e),t.$notify("error filled","Échec de l'assignation !","Les demandes n'ont pas pu vous être assignées",{duration:4e3,permanent:!1})})).finally((function(){t.loading=!1}))}}),computed:Object(i["a"])(Object(i["a"])({},Object(o["c"])({jobs:"getUnassignedJobs"})),{},{isTouchscreen:function(){return"ontouchstart"in window},assignText:function(){var t=" demandes vont vous être attribuées.";return 1===this.selectedJobs.length&&(t=" demande va vous être attribuée."),this.selectedJobs.length+t+" Souhaitez-vous continuer ?"}}),watch:{jobs:function(){var t=this;this.selectedJobs=this.jobs.filter((function(e){return t.$refs.table.isSelected(e)})),this.dialog&&0===this.selectedJobs.length&&(this.dialog=this.loading=!1)}},mounted:function(){this.retrieveUnassignedJobs()}},u=d,v=(n("0419"),n("2877")),m=Object(v["a"])(u,a,s,!1,null,null,null);e["default"]=m.exports},c7ba:function(t,e,n){}}]);